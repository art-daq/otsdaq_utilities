<!DOCTYPE HTML>
<html lang="en"> 
	<head>
		<title>Epics CA Monitor</title>
		<style type="text/css">			
			body {
				background-color: rgb(200,200,200);
			}
			
			#clearDiv {
				clear: both;
			}
			
			a {
				color: blue;
			}
			
			
			#fileBlock {
				background-color: rgb(26,148,49);
			}				

			#mainBlock {
				background-color: rgb(240,234,214);
			}

			#editBlock {
				background-color: rgb(200,0,0);
			}
			
			.mainBlock {
				position:absolute;
			}
									
		</style>
		
		
		<script type="text/JavaScript" src="/WebPath/js/Globals.js"></script>	
		<script type="text/JavaScript" src="/WebPath/js/Debug.js"></script>	
		<script type="text/JavaScript" src="/WebPath/js/DesktopWindowContentCode.js"></script>
		
		
		<script>		
			
			
		
			//functions:			
				//init()					
				

					
			/////////////////////////////////////////////////////////////////////////////////////////
			/////////////////////////////////////////////////////////////////////////////////////////
			
			//init called once body has loaded
			function initEdit() {			
				Debug.log("*****************************************init() was called");

//				DesktopContent.XMLHttpRequest("Default?RequestType=getList","",handlerFunction);


				window.onresize = redrawWindow;
				redrawWindow(); //redraw window for first time
			}	
			
			function handlerFunction(req) {
				Debug.log("handlerFunction() was called. Req: " + req.responseText);

				//var child1data = DesktopContent.getXMLValue(req,"child");
				//var child2data = DesktopContent.getXMLValue(req,"child2");
				
				//Debug.log("--child1data:",child1data," --child2data:",child2data);
				//block1El = document.getElementById('block1');
				//block1.innerHTML = child1data;
				
			}
			
			function addPV(pv)
			{
				//console.log("edit");
			}
			
			

			function redrawWindow(clicked, hover) {
				//Debug.log("FileTree redrawWindow() to " + window.innerWidth + " - " + window.innerHeight);
				
				//console.log(window.parent.pvList_);
				var ul = document.createElement("list");
				var maxWidth = 0;
				
				window.parent.pvList_.forEach(function(pv){
					
					//console.log(pv);
					
					var li = document.createElement("li");
					
					var button = document.createElement("button");
					button.style.width = "auto";
					button.style.overflow =  "hidden";
					button.id = pv; 
					button.onclick = function(){parent.addPV(pv)};//"addPV()";// + pv + ')';
					button.innerHTML = pv;
					if(button.style.width > maxWidth)
					{
						maxWidth = button.style.width;
					}
					li.appendChild(button);
					ul.appendChild(li);
						
					
				});
				
				document.getElementById("tilesDiv").innerHTML = "";
				document.getElementById("tilesDiv").appendChild(ul);

				if(maxWidth <= (document.getElementById("tilesDiv").style.width / 3))
				{
					document.getElementById("tilesDiv").style.width = maxWidth
				}
				else
				{
					document.getElementById("tilesDiv").style.width = document.getElementById("tilesDiv").style.width / 4;
				}
				
	
			}
			
		</script>
		
	</head>
	
	
	<body onload='Javascript:initEdit();'>	
			
		<div class='mainBlock' id='buttonsDiv'>
		</div>
		<div class='mainBlock' id='tilesDiv'></div>
				
		
	</body>
	
</html>
